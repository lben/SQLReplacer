import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Alignment

def create_excel_with_dataframes(df1, df2, output_file, sheet_name='Sheet1'):
    # Create a Pandas Excel writer using XlsxWriter as the engine
    with pd.ExcelWriter(output_file, engine='openpyxl') as writer:
        # Write each dataframe to the excel file
        df1.to_excel(writer, sheet_name=sheet_name, startrow=3, startcol=2, index=False)
        df2.to_excel(writer, sheet_name=sheet_name, startrow=3, startcol=len(df1.columns) + 4, index=False)
        
        # Access the XlsxWriter workbook and worksheet objects
        workbook = writer.book
        worksheet = writer.sheets[sheet_name]
        
        # Add titles for each dataframe
        worksheet.cell(row=2, column=3, value="DataFrame 1")
        worksheet.cell(row=2, column=len(df1.columns) + 5, value="DataFrame 2")
        
        # Merge cells for titles and center them
        worksheet.merge_cells(start_row=2, start_column=3, end_row=2, end_column=len(df1.columns) + 2)
        worksheet.merge_cells(start_row=2, start_column=len(df1.columns) + 5, end_row=2, end_column=len(df1.columns) + len(df2.columns) + 4)
        
        # Center align the titles
        for cell in worksheet["2"]:
            cell.alignment = Alignment(horizontal='center')

# Example usage
df1 = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6], 'C': [7, 8, 9]})
df2 = pd.DataFrame({'X': [10, 11, 12], 'Y': [13, 14, 15], 'Z': [16, 17, 18]})

create_excel_with_dataframes(df1, df2, 'output.xlsx')